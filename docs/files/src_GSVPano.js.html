<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/GSVPano.js - GSVPano</title>
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap-3.3.1.min.css">
    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body>
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <a href="#" class="navbar-brand">
            GSVPano
        </a>
      </div>
      <p class="navbar-text">
        API Docs for Version: <b>1.0.0</b>
      </p>
       <form class="navbar-form pull-right">
        <input type="text" class="form-control" placeholder="Search for classes/modules..." data-obj='["classes/EventEmitter", "classes/Pano", "classes/PanoLoader", "modules/EventEmitter", "modules/GSVPANO"]'>
      </form>
    </div>
  </nav>
<div class="container">
  <div class="row">
      <div class="col-xs-3">
    <div>
        <h3><b>APIs</b></h3>
        <div id="sidebar">
            <div>
                <input class="form-control" type="search" placeholder="Search for Classes">
            </div>
            <ul id="main-nav" class="nav nav-tabs">
                <li class="active"><a href="#classes" data-toggle="tab">Classes</a></li>
                <li><a href="#modules" data-toggle="tab">Modules</a></li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane active" id="classes">
                    <ul id="api-classes" class="nav nav-list">
                            <li><a href="../classes/EventEmitter.html">EventEmitter</a></li>
                            <li><a href="../classes/Pano.html">Pano</a></li>
                            <li><a href="../classes/PanoLoader.html">PanoLoader</a></li>
                    </ul>
                </div>
                <div class="tab-pane" id="modules">
                    <ul id="api-modules" class="nav nav-list">
                            <li><a href="../modules/EventEmitter.html">EventEmitter</a></li>
                            <li><a href="../modules/GSVPANO.html">GSVPANO</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
      </div>
      <div class="col-xs-9">
              <form id="options-form" class="btn-group warning form-inline pull-right" data-toggle="buttons">
                  <label for="api-show-inherited" class="btn btn-info active">
                      <input type="checkbox" id="api-show-inherited" checked>
                      Inherited
                  </label>
          
                  <label for="api-show-protected" class="btn btn-info">
                      <input type="checkbox" id="api-show-protected">
                      Protected
                  </label>
          
                  <label for="api-show-private" class="btn btn-info">
                      <input type="checkbox" id="api-show-private">
                      Private
                  </label>
                  <label for="api-show-deprecated" class="btn btn-info">
                      <input type="checkbox" id="api-show-deprecated">
                      Deprecated
                  </label>
              </form>          <div class="apidocs">
              <div id="docs-main">
                  <div class="content">
                      <div class="page-header">
                          <h1>src/GSVPano.js <small>File</small></h1>
                      </div>
                      
                      <div class="file">
                          <pre class="prettyprint linenums">
                      // GSVPano.js
                      // Copyright (c) 2014 Heganoo
                      // https://github.com/heganoo/GSVPano
                      
                      var eventEmitter = require(&#x27;event-emitter&#x27;);
                      
                      /**
                       * @module GSVPANO
                       * @author Hegano
                       * @author juampi92
                       */
                      var GSVPANO = GSVPANO || {};
                      
                      
                      /**
                       * Fetch URL. Use this parameter in case the URL stops working. At
                       * the end of this string, the parameters &amp;panoid, &amp;x, &amp;y, &amp;zoom 
                       * and the current timestamp are appended.
                       * @property GSVPANO._url
                       * @type {String}
                       * @default &#x27;http://maps.google.com/cbk?output=tile&#x27;
                       */
                      // &#x27;https://geo0.ggpht.com/cbk?cb_client=maps_sv.tactile&amp;authuser=0&amp;hl=en&amp;output=tile&amp;nbt&amp;fover=2&#x27;
                      // &#x27;https://cbks2.google.com/cbk?cb_client=maps_sv.tactile&amp;authuser=0&amp;hl=en&amp;output=tile&#x27;
                      
                      GSVPANO._url = &#x27;http://maps.google.com/cbk?output=tile&#x27;;
                      
                      /**
                       * Data Fetch URL. Use this parameter in case the URL stops working.
                       * At the end of this string, the parameter &amp;ll is appended.
                       * @property GSVPANO._data_url
                       * @type {String}
                       * @default &#x27;https://cbks0.google.com/cbk?cb_client=maps_sv.tactile&amp;authuser=0&amp;hl=en&amp;output=polygon&amp;it=1%3A1&amp;rank=closest&amp;radius=350&#x27;
                       */
                      GSVPANO._data_url = &#x27;https://cbks0.google.com/cbk?cb_client=maps_sv.tactile&amp;authuser=0&amp;hl=en&amp;output=polygon&amp;it=1%3A1&amp;rank=closest&amp;radius=350&#x27;;
                      
                      GSVPANO.Pano = require(&#x27;./Pano&#x27;);
                      
                      /**
                       * @class PanoLoader
                       * @extends {EventEmitter}
                       * @constructor
                       * @param {Object} parameters
                       * @param {Number} parameters.zoom Zoom (default 1)
                       * @example
                       *       var loader = GSVPANO.PanoLoader({ zoom: 3 });
                       */
                      GSVPANO.PanoLoader = function(parameters) {
                        &#x27;use strict&#x27;;
                      
                        eventEmitter(this);
                      
                        var self = this,
                          _parameters = parameters || {},
                          _location,
                          _zoom,
                          _panoId,
                          _panoClient = new google.maps.StreetViewService(),
                          _count = 0,
                          _total = 0,
                          _canvas = document.createElement(&#x27;canvas&#x27;),
                          _ctx = _canvas.getContext(&#x27;2d&#x27;),
                          rotation = 0,
                          pitch = 0,
                          copyright = &#x27;&#x27;;
                      
                        /**
                         * @event panorama.data
                         * @param {Pano} pano
                         * @example
                         *     loader.on(&#x27;panorama.data&#x27;, function(pano){
                         *       console.log(&#x27;Pano &#x27; + pano.id + &#x27; added&#x27;);
                         *     });
                         */
                      
                        /**
                         * @event panorama.nodata
                         * @param {Google.Maps.LatLng} location
                         * @param {Google.Maps.StreetViewStatus} status
                         */
                      
                        /**
                         * @event progress
                         * @param {Number} p
                         * @param {Pano} pano
                         * @example
                         *         loader.on(&#x27;progress&#x27;, function(p, pano) {
                         *           console.log(&#x27;Pano progress: &#x27; + p + &#x27;%&#x27;);
                         *         });
                         */
                        var setProgress = function(pano, p) {
                          self.emit(&#x27;progress&#x27;, p, pano);
                        };
                        /**
                         * @event panorama.load
                         * @param {Pano} pano
                         * @example
                         *     loader.on(&#x27;panorama.load&#x27;, function(pano){
                         *       $container.append(pano.canvas);
                         *     });
                         */
                        var handlePanoLoad = function(callback, pano) {
                          self.emit(&#x27;panorama.load&#x27;, pano);
                          if (callback) {
                            callback(pano);
                          }
                        };
                      
                        /**
                         * @event error
                         * @param {String} message
                         * @example
                         *     loader.on(&#x27;error&#x27;, function(message){
                         *       console.log(message)
                         *     });
                         */
                        var throwError = function(message) {
                          self.emit(&#x27;error&#x27;, message);
                        };
                      
                        /**
                         * Middle function for working with IDs.
                         * @method loadData
                         * @param {Google.Maps.Location} location
                         * @deprecated Disabled right now
                         */
                        /*this.loadData = function(location) {
                          var self = this;
                          var url;
                      
                          //url = &#x27;https://maps.google.com/cbk?output=json&amp;hl=x-local&amp;ll=&#x27; + location.lat() + &#x27;,&#x27; + location.lng() + &#x27;&amp;cb_client=maps_sv&amp;v=3&#x27;;
                          url = GSVPANO._data_url + &#x27;&amp;ll=&#x27; + location.lat() + &#x27;,&#x27; + location.lng();
                      
                          var http_request = new XMLHttpRequest();
                          http_request.open(&quot;GET&quot;, url, true);
                          http_request.onreadystatechange = function() {
                            if (http_request.readyState == 4 &amp;&amp; http_request.status == 200) {
                              var data = JSON.parse(http_request.responseText);
                              // self.loadPano(location, data.result[0].id);
                            }
                          };
                          http_request.send(null);
                        };*/
                      
                        /**
                         * Fires panorama.data, panorama.nodata
                         * @method load
                         * @param {Google.Maps.Location} location
                         * @param {Function} callback
                         * @example
                         *         // Let the panorama.load event handle it&#x27;s load
                         *         loader.load(new google.maps.LatLng(lat, lng));
                         * @example
                         *         // Also handle the load individually
                         *         loader.load(new google.maps.LatLng(lat, lng), function(pano){
                         *           // This individual load has been completed
                         *           container.append(pano.canvas);
                         *         });
                         */
                        this.load = function(location, callback) {
                          var self = this;
                      
                          _panoClient.getPanoramaByLocation(location, 50, function(result, status) {
                            if (status === google.maps.StreetViewStatus.OK) {
                      
                              var pano = new GSVPANO.Pano({
                                  id: result.location.pano,
                                  rotation: result.tiles.centerHeading,
                                  pitch: result.tiles.originPitch,
                                  copyright: result.copyright,
                                  imageDate: result.imageDate,
                                  location: result.location,
                                  zoom: _zoom
                                })
                                .on(&#x27;complete&#x27;, handlePanoLoad.bind(self, callback))
                                .on(&#x27;progress&#x27;, setProgress.bind(self, pano));
                      
                              pano.compose();
                              self.emit(&#x27;panorama.data&#x27;, pano);
                            } else {
                              self.emit(&#x27;panorama.nodata&#x27;, location, status);
                              throwError(&#x27;Could not retrieve panorama for the following reason: &#x27; + status);
                            }
                          });
                        };
                      
                        /**
                         * @method setZoom
                         * @param {Number} z
                         */
                        this.setZoom = function(z) {
                          _zoom = z;
                        };
                      
                        // Default zoom.
                        this.setZoom(_parameters.zoom || 1);
                      
                      };
                      
                      global.GSVPANO = module.exports = GSVPANO;
                          </pre>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</div>
<script src="../assets/vendor/jquery/jquery-1.11.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap-3.3.1.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap-typeahead.js"></script>

<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/yuidoc-bootstrap.js"></script>
<script>prettyPrint();</script>
</body>
</html>